<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Database - Dashboard</title>

    <!-- CSS File -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <!-- Dashboard View -->
    <div id="dashboard-view" class="container">
        <h1>Distributed Database Dashboard</h1>

        <!-- Settings Section -->
        <div class="settings-section">
            <div class="form-group">
                <label for="isolation-level">Isolation Level</label>
                <select id="isolation-level">
                    <option value="read-uncommitted">Read Uncommitted</option>
                    <option value="read-committed">Read Committed</option>
                    <option value="repeatable-read">Repeatable Read</option>
                    <option value="serializable">Serializable</option>
                </select>
            </div>

            <div class="form-group">
                <label for="failure-simulation">Failure Simulation</label>
                <select id="failure-simulation">
                    <option value="none">None</option>
                    <option value="crash-node1-write">Crash Node 1 during write</option>
                    <option value="crash-node23-write">Crash Node 2/3 during write</option>
                    <option value="central-offline">Central Node offline</option>
                    <option value="regional-offline">Regional Node offline</option>
                </select>
            </div>

            <button onclick="applySettings()">Apply Settings</button>
        </div>

        <!-- Nodes Grid -->
        <div class="nodes-grid">
            <div class="node-card" onclick="navigateToNode(1)">
                <div class="node-header">
                    <div class="node-title">Node 1 (Central)</div>
                    <span class="status-indicator status-online" id="node1-status">LOADING...</span>
                </div>
                <div class="node-info">
                    <div class="info-row">
                        <span class="info-label">Last Update:</span>
                        <span id="node1-update">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Rows:</span>
                        <span id="node1-rows">--</span>
                    </div>
                </div>
            </div>

            <div class="node-card" onclick="navigateToNode(2)">
                <div class="node-header">
                    <div class="node-title">Node 2 (Regional)</div>
                    <span class="status-indicator status-online" id="node2-status">LOADING...</span>
                </div>

                <div class="node-info">
                    <div class="info-row">
                        <span class="info-label">Last Update:</span>
                        <span id="node2-update">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Rows:</span>
                        <span id="node2-rows">--</span>
                    </div>
                </div>
            </div>

            <div class="node-card" onclick="navigateToNode(3)">
                <div class="node-header">
                    <div class="node-title">Node 3 (Regional)</div>
                    <span class="status-indicator status-online" id="node3-status">LOADING...</span>
                </div>
                <div class="node-info">
                    <div class="info-row">
                        <span class="info-label">Last Update:</span>
                        <span id="node3-update">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Rows:</span>
                        <span id="node3-rows">--</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Node View Template -->
    <div id="node-view" class="container node-view">
        <div class="view-header">
            <div>
                <button class="back-button" onclick="navigateToDashboard()">← Back</button>
                <span style="font-size: 24px; font-weight: bold;" id="current-node-title">Node 1</span>
            </div>
        </div>

        <!-- Row Count Display -->
        <div class="row-count-display">
            Showing <span id="current-rows">0</span> of <span id="total-rows">0</span> rows
        </div>

        <!-- Filter Section -->
        <div class="filter-section">
            <div class="form-group">
                <label for="filter-titleid">Title ID</label>
                <input type="text" id="filter-titleid" placeholder="Filter by Title ID">
            </div>
            <div class="form-group">
                <label for="filter-title">Title</label>
                <input type="text" id="filter-title" placeholder="Filter by Title">
            </div>
            <div class="form-group">
                <label for="filter-region">Region</label>
                <input type="text" id="filter-region" placeholder="Filter by Region">
            </div>
            <button onclick="applyFilters()">Apply Filters</button>
            <button class="secondary-button" onclick="clearFilters()">Clear</button>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="insert-button" onclick="openInsertModal()">+ Insert</button>
            <button class="concurrency-button" onclick="simulateConcurrency()">⚡ Simulate Concurrency</button>
        </div>

        <table class="data-table" id="data-table">
            <thead>
                <tr>
                    <th style="width: 10%;">Title ID</th>
                    <th style="width: 5%;">Order</th>
                    <th style="width: 20%;">Title</th>
                    <th style="width: 8%;">Region</th>
                    <th style="width: 8%;">Language</th>
                    <th style="width: 12%;">Types</th>
                    <th style="width: 15%;">Attributes</th>
                    <th style="width: 7%;">Original</th>
                    <th style="width: 15%;">Actions</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- Data will be loaded dynamically -->
            </tbody>
        </table>

        <!-- Load More Button -->
        <div class="load-more-section">
            <button id="load-more-btn" onclick="loadMoreRows()">Load More Rows</button>
        </div>
    </div>

    <!-- Insert Modal -->
    <div id="insert-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Insert New Record</h2>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="ordering">Ordering *</label>
                        <input type="number" id="ordering" placeholder="Enter ordering number" required>
                    </div>
                    <div class="form-group">
                        <label for="title-region">Region *</label>
                        <select id="title-region" required>
                            <option value="">Select Region</option>
                            <option value="US">US</option>
                            <option value="JP">JP</option>
                            <option value="ES">ES</option>
                            <option value="FR">FR</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="title-name">Title *</label>
                    <textarea id="title-name" placeholder="Enter title name" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="language">Language *</label>
                        <input type="text" id="language" placeholder="e.g., en, ja, es" maxlength="10" required>
                    </div>
                    <div class="form-group">
                        <label for="types">Types *</label>
                        <input type="text" id="types" placeholder="e.g., movie, tvSeries" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="attributes">Attributes</label>
                    <input type="text" id="attributes" placeholder="Enter attributes (optional)">
                </div>

                <div class="form-group">
                    <label for="is-original">Is Original Title? *</label>
                    <select id="is-original" required>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="cancel-button" onclick="closeInsertModal()">Cancel</button>
                <button onclick="submitInsert()">Submit</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Edit Record</h2>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-titleid">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-ordering">Ordering *</label>
                        <input type="number" id="edit-ordering" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-region">Region *</label>
                        <input type="text" id="edit-region" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit-title">Title *</label>
                    <textarea id="edit-title" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-language">Language *</label>
                        <input type="text" id="edit-language" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-types">Types *</label>
                        <input type="text" id="edit-types" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit-attributes">Attributes</label>
                    <input type="text" id="edit-attributes">
                </div>

                <div class="form-group">
                    <label for="edit-is-original">Is Original Title? *</label>
                    <select id="edit-is-original" required>
                        <option value="1">Yes</option>
                        <option value="0">No</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="cancel-button" onclick="closeEditModal()">Cancel</button>
                <button onclick="submitUpdate()">Update</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/nodeView.js') }}"></script>
</body>
</html>